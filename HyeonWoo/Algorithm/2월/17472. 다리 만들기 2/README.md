# [Gold I] 다리 만들기 2 - 17472

[문제 링크](https://www.acmicpc.net/problem/17472) 

### 성능 요약

메모리: 18316 KB, 시간: 280 ms

### 분류

구현, 그래프 이론, 브루트포스 알고리즘, 그래프 탐색, 너비 우선 탐색, 깊이 우선 탐색, 최소 스패닝 트리

### 문제 설명

섬으로 이루어진 나라가 있고, 모든 섬을 다리로 연결하려고 한다. 이 나라의 지도는 N×M 크기의 이차원 격자로 나타낼 수 있고, 격자의 각 칸은 땅이거나 바다이다.

섬은 연결된 땅이 상하좌우로 붙어있는 덩어리를 말하고, 아래 그림은 네 개의 섬으로 이루어진 나라이다. 색칠되어있는 칸은 땅이다.

![1](https://user-images.githubusercontent.com/88186460/222297365-58c7b8e0-8009-4470-9d69-c03af449941f.png)

<br/>

다리는 바다에만 건설할 수 있고, 다리의 길이는 다리가 격자에서 차지하는 칸의 수이다. 다리를 연결해서 모든 섬을 연결하려고 한다. 섬 A에서 다리를 통해 섬 B로 갈 수 있을 때, 섬 A와 B를 연결되었다고 한다. 다리의 양 끝은 섬과 인접한 바다 위에 있어야 하고, 한 다리의 방향이 중간에 바뀌면 안된다. 또, 다리의 길이는 2 이상이어야 한다.

다리의 방향이 중간에 바뀌면 안되기 때문에, 다리의 방향은 가로 또는 세로가 될 수 밖에 없다. 방향이 가로인 다리는 다리의 양 끝이 가로 방향으로 섬과 인접해야 하고, 방향이 세로인 다리는 다리의 양 끝이 세로 방향으로 섬과 인접해야 한다.

섬 A와 B를 연결하는 다리가 중간에 섬 C와 인접한 바다를 지나가는 경우에 섬 C는 A, B와 연결되어있는 것이 아니다. 

아래 그림은 섬을 모두 연결하는 올바른 2가지 방법이고, 다리는 회색으로 색칠되어 있다. 섬은 정수, 다리는 알파벳 대문자로 구분했다.

![2](https://user-images.githubusercontent.com/88186460/222297378-d840108a-dbb7-445d-8ca6-b5e134d562c1.png)

다리의 총 길이: 13

D는 2와 4를 연결하는 다리이고, 3과는 연결되어 있지 않다.

![3](https://user-images.githubusercontent.com/88186460/222297376-7fe51350-6d35-4364-86ba-c49db3aad08c.png)

다리의 총 길이: 9 (최소)

<br/>

다음은 올바르지 않은 3가지 방법이다

![4](https://user-images.githubusercontent.com/88186460/222297375-cb62d667-afd6-46d4-8dfb-b7de5f0846e6.png)

C의 방향이 중간에 바뀌었다

![5](https://user-images.githubusercontent.com/88186460/222297373-a0551b2b-cf99-4465-9c3a-2bcd52b051f2.png)

D의 길이가 1이다.

![6](https://user-images.githubusercontent.com/88186460/222297372-1e1f901e-4641-4be9-b375-ff4637331820.png)

가로 다리인 A가 1과 가로로 연결되어 있지 않다.

<br/>

다리가 교차하는 경우가 있을 수도 있다. 교차하는 다리의 길이를 계산할 때는 각 칸이 각 다리의 길이에 모두 포함되어야 한다. 아래는 다리가 교차하는 경우와 기타 다른 경우에 대한 2가지 예시이다.

A의 길이는 4이고, B의 길이도 4이다.

![7](https://user-images.githubusercontent.com/88186460/222297369-8f4c166a-96a6-423c-8289-b2bae2cc97c9.png)

총 다리의 총 길이: 4 + 4 + 2 = 10

![8](https://user-images.githubusercontent.com/88186460/222297366-726b3724-0ca0-440b-85be-18d800aee61f.png)

다리 A: 2와 3을 연결 (길이 2)

다리 B: 3과 4를 연결 (길이 3)

다리 C: 2와 5를 연결 (길이 5)

다리 D: 1과 2를 연결 (길이 2)

총 길이: 12

<br/>

나라의 정보가 주어졌을 때, 모든 섬을 연결하는 다리 길이의 최솟값을 구해보자.

### 입력 

첫째 줄에 지도의 세로 크기 N과 가로 크기 M이 주어진다. 둘째 줄부터 N개의 줄에 지도의 정보가 주어진다. 각 줄은 M개의 수로 이루어져 있으며, 수는 0 또는 1이다. 0은 바다, 1은 땅을 의미한다.

### 출력 

모든 섬을 연결하는 다리 길이의 최솟값을 출력한다. 모든 섬을 연결하는 것이 불가능하면 -1을 출력한다.

### 제한

- 1 ≤ N, M ≤ 10
- 3 ≤ N×M ≤ 100
- 2 ≤ 섬의 개수 ≤ 6
 
### 풀이

#### 고려 조건
- 다리는 직선으로만 가능하다. (수직, 수평)
- 섬을 연결하는 다리는 끝과 끝으로 연결되어야 한다. 즉 옆에 섬이 붙어있더라도 다리가 연결된 것이 아니다.
- 최소 2칸 이상이어야 다리로 인정된다.

#### 풀이 방법
가장 먼저 주어진 지도를 탐색하며 섬을 찾고, 해당 섬에서 가능한 모든 다리의 경우를 저장한다.

![2E5AD1E4-4A88-4E4E-B966-FEC1FAD2F7E6](https://user-images.githubusercontent.com/88186460/222374278-686583d0-1c8c-4017-a1e5-bc383d91f9b4.jpg)

![074A0BF7-E690-4B70-8A00-5613D1AEA2B3](https://user-images.githubusercontent.com/88186460/222374295-57c77dfb-d01b-49e9-832f-6d56642dc299.jpg)

다음은 주어진 다리를 통해 섬을 탐색해야 한다.

이때 구해야 할 부분은 모든 섬이 연결된 상태여야 하기 때문에 어느 섬에서 탐색을 시작하든 상관이 없다.

즉 임의의 섬에서 탐색을 시작한다.

하지만 단순 bfs, dfs 탐색으로는 모든 경우를 구할 수 없다.

![B809629B-2189-4739-BE71-3ED85049D339](https://user-images.githubusercontent.com/88186460/222374592-92d73c09-caf3-4c52-863d-a5abaa388540.jpg)

왼쪽을 보면 dfs를 통해 섬을 탐색한 모습인데 방문 체크를 기반으로 탐색을 하는거라 모든 섬을 탐색하기 어렵다.

bfs도 마찬가지이다.

그렇다면 방문체크를 해야할까? 방문체크는 필요하다. 하지만 다음 섬으로 넘어갈 때 방문의 유무로 결정하는 것이 아닌 어떤 방향으로 무슨 다리를 건넜는지로 판단한다.

가장 중요하게 생각해야 되는 조건은 다음 섬이 이미 한번 왕복한 섬이라면 갈 필요가 없다는 것이다.

해당 조건으로 다음섬을 갈지 안갈지 판단하며 탐색한 것이 오른쪽 탐색이다.
